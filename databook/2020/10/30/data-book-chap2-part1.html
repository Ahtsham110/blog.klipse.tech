<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="shortcut icon" href="/assets/favicon2.png">

  <title>Decrease complexity by separating Code from Data</title>
  <meta name="description" content="Decrease complexity of your system by separating Code from Data. Data oriented programming.">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/asciidoc-pygments.css">
  <link rel="canonical" href="https://blog.klipse.tech//databook/2020/10/30/data-book-chap2-part1.html">
  <link rel="alternate" type="application/rss+xml" title="An interactive journey into functional programming with Yehonathan Sharvit" href="https://blog.klipse.tech//feed.xml">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">

  <!-- start: facebook -->
  <meta property="og:title" content="Decrease complexity by separating Code from Data">
  <meta property="og:image" content="https://blog.klipse.tech/assets/klipse.png">
  <meta property="og:description" content="Decrease complexity of your system by separating Code from Data. Data oriented programming.">
  <meta property="og:site_name" content="An interactive journey into functional programming with Yehonathan Sharvit">
  <meta property="article:author" content="Yehonathan Sharvit">
  <!-- end: facebook -->


</head>

  <body>
    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">An interactive journey into functional programming with Yehonathan Sharvit</a>

    <div class="site-title" style="float:right;margin-top:14px;">
<a class="github-button" href="https://github.com/viebel/klipse" data-size="large" data-show-count="true" aria-label="Star viebel/klipse on GitHub">Klipse</a>
</div>
<script async defer src="https://buttons.github.io/buttons.js"></script>

    <!-- <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/data-oriented-programming-book.html">Data Oriented Programming</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav> -->

  </div>

</header>

    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <div class="left-post-header">
      <img src="https://blog.klipse.tech/assets/klipse.png">
    </div>
    <div>
      <h1 class="post-title" itemprop="name headline">Decrease complexity by separating Code from Data</h1>
      <p class="post-meta"><time datetime="2020-10-30T07:21:32+00:00" itemprop="datePublished">Oct 30, 2020</time>
	 •
	<span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Yehonathan Sharvit</span></span>
	
	</p>
    </div>

  </header>
  <div class="post-content" itemprop="articleBody">
    <div id="preamble">
<div class="sectionbody">
<div>
  <p>
    This article is an excerpt from my upcoming book about Data Oriented Programming. The book will be published by Manning, once it is completed (hopefully in 2021).
  </p>

  <p>
    More excerpts are available on my <a href="/data-oriented-programming-book.html">blog</a>.
  </p>

  <p>
    Enter your email address below to get notified when the book is published.
  </p>

  <form style="text-align: left;" action="https://tinyletter.com/data-oriented-programming" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/data-oriented-programming', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
	  <input type="email" style="width:180px" name="email" id="tlemail" placeholder="Your email address"/>
	  <input type="hidden" value="1" name="embed"/>
	  <input style="padding-left:10px; font-size: larger; color: #5f7fbf; font-weight: bold;" type="submit" value="Subscribe" />
  </form>
  <br>
</div>
</div>
</div>
<h1 id="introduction" class="sect0">Introduction</h1>
<div class="paragraph">
<p>As we mentioned in /databook/2020/09/29/do-principles.html[Chapter 0], the big insight of Data Oriented Programming (DO) is that we can <strong>decrease the complexity</strong> of our systems by <strong>separating code from data</strong>. Indeed, when code is separated from data, our systems are made of two main pieces that can be <strong>thought separately</strong>: Data entities and Code modules.</p>
</div>
<div class="paragraph">
<p>This chapter is a deep dive in DO Principle #1:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Principle #1: Separate <strong>code</strong> from <strong>data</strong> in a way that the <strong>code</strong> resides in functions whose behavior does not depend on <strong>data</strong> that is somehow encapsulated in the function&#8217;s context.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>We <strong>illustrate</strong> the separation between code and data in the context of a Library Management system and we unveil the <strong>benefits</strong> that this separation brings to the system:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The system is <strong>simple</strong>: it is easy to understand</p>
</li>
<li>
<p>The system is <strong>flexible</strong>: quite often, it requires no design changes to adapt to changing requirements</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We show how to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Design a system</strong> where code and data are separate</p>
</li>
<li>
<p><strong>Write code</strong> that respects the separation between code and data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This chapter focuses on the <strong>design of the code part</strong> of a system where code and data are separate. In Chapter 3, we will focus on the <strong>design of the data part</strong> of the system. As we progress in the book, we will discover other benefits of separating code from data.</p>
</div>
<h1 id="the-two-parts-of-a-do-system" class="sect0">The two parts of a DO system</h1>
<div class="paragraph">
<p>You invite Joe to your office. Joe is a 40-year old developer that used to be a Java developer for many years and moved to Clojure 7 years ago.</p>
</div>
<div class="paragraph">
<p>When you tell Joe about the Library management system you built (Chapter 1) and the struggle you had to adapt to changing requirements, he is not surprised.</p>
</div>
<div class="paragraph">
<p>Joe tells you that the systems he and his team have build in Clojure over the last 7 years are <strong>less complex</strong> and <strong>more flexible</strong> than the systems he used to build in Java. The main cause of this benefits is that the systems he built were following principles of Data Oriented Programming.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What makes DO systems <strong>less complex</strong> and <strong>more flexible</strong>?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> The first <strong>insight</strong> of DO is about the relationships between <strong>code</strong> and <strong>data</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> You mean the <strong>encapsulation</strong> of data in objects?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Actually, DO is against encapsulation.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Why is that? I thought encapsulation was a positive programming paradigm.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Data encapsulation has its merits and drawbacks: Think again at what happened when you implemented Nancy&#8217;s LMS (in Chapter 1). According to DO, the main cause of the <strong>complexity</strong> of systems and their <strong>lack of flexibility</strong> is because code and data are mixed together (in objects).</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Does it mean that in order to adhere to DO, I need to get rid of OO and learn a Functional programming language?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> No. DO principles are <strong>language agnostic</strong>: they can be applied both in OO and FP languages.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Cool! I was afraid that you were going to teach me about monads, algebraic data types and high order functions.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> None of this is required in DO.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> How does the separation between code and data looks like in DO?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Data is represented by <strong>data entities</strong> that hold members only. Code is aggregated into <strong>modules</strong> where all the functions are <strong>stateless</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What do you mean by stateless functions?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Instead of having the state encapsulated in the object, the data entity is passed as an argument.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I don&#8217;t get that.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Let me make it <a href="#principle1-nutshell">visual</a>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> It&#8217;s still not clear</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> It will become clearer when I show you how it looks like in the context of your library management system.</p>
</div>
<div id="principle1-nutshell" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/principle1-nutshell.png" alt="principle1 nutshell">
</div>
<div class="title">Figure 1. The separation between code and data</div>
</div>
<div class="paragraph">
<p><strong>YOU</strong>: OK. Shall we start we code or with data?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Well, it&#8217;s <strong>Data</strong> oriented programming. Let&#8217;s start with Data!</p>
</div>
<h1 id="data-entities" class="sect0">Data entities</h1>
<div class="paragraph">
<p>In DO, we start the design process by discovering the data entities of our system.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> What are the <strong>data entities</strong> of your system?</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What do you mean by <em>data entities</em>?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> I mean the parts of your system that hold <strong>information</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Well, it&#8217;s a library management system, so for sure we have <strong>books</strong> and <strong>members</strong>.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Of course. But there are more: One way to discover the data entities of a system is to look for nouns and <strong>noun phrases</strong> in the requirements of the system.</p>
</div>
<div class="paragraph">
<p>You look at Nancy&#8217;s requirement napkin and you highlight the <strong>nouns</strong> and  <strong>noun phrases</strong> that seem to represent data entities of the system:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Highlighting terms in the requirements that correspond to data entities</div>
<div class="ulist">
<ul>
<li>
<p>Two kinds of <strong>users</strong>: library <strong>members</strong> and <strong>librarians</strong></p>
</li>
<li>
<p><strong>Users</strong> log in to the system via email and password.</p>
</li>
<li>
<p>Members can borrow <strong>books</strong></p>
</li>
<li>
<p>Members and librarians can search books by title or by <strong>author</strong></p>
</li>
<li>
<p>Librarians can block and unblock members (e.g. when they are late in returning a book)</p>
</li>
<li>
<p>Librarians can list the <strong>books currently lent</strong> by a member</p>
</li>
<li>
<p>There could be several <strong>copies of a book</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Data entities are the parts of your system that hold information</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Excellent. Can you see a natural way to group the entities?</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Not sure, but it seems to me that <em>users</em>, <em>members</em> and <em>librarians</em> form a group while <em>books</em>, <em>authors</em> and <em>book copies</em> form another group.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Sounds good to me. How would you call each group?</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> <strong>User management</strong> for the first group and <strong>Catalog</strong> for the second group.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">The data entities of the system organized in a nested list</div>
<div class="ulist">
<ul>
<li>
<p>The catalog data</p>
<div class="ulist">
<ul>
<li>
<p>Data about books</p>
</li>
<li>
<p>Data about authors</p>
</li>
<li>
<p>Data about book items</p>
</li>
<li>
<p>Data about book lendings</p>
</li>
</ul>
</div>
</li>
<li>
<p>The user management data</p>
<div class="ulist">
<ul>
<li>
<p>Data about users</p>
</li>
<li>
<p>Data about members</p>
</li>
<li>
<p>Data about librarians</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I am not sure about the relationships between books and authors: should it be association or composition?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Don&#8217;t worry too much about the details for the moment. We will refine our data entities design later (Chapter 3). For now, let&#8217;s visualize the two groups in a <a href="#lms-data-sketch">mindmap</a>.</p>
</div>
<div id="lms-data-sketch" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/lms-data.png" alt="lms data">
</div>
<div class="title">Figure 2. The data entities of the system organized in a mind map</div>
</div>
<div class="paragraph">
<p>The most precise way to visualize the data entities of a DO system is to draw a data entity diagram with different arrows for association and composition. We will come back to data entity diagram in Chapter 3.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Discover the data entities of your system and group them into high level groups.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>We will get deeper into the design and the representation of data entities in Chapter 3. For now, let&#8217;s simplify and say that the data of our library system is made of two high level groups: <strong>User Management</strong> and <strong>Catalog</strong>.</p>
</div>
<h1 id="code-modules" class="sect0">Code modules</h1>
<div class="paragraph">
<p>The second step of the design process in DO, is to define the <strong>code modules</strong> of the system.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Now that you have identified the data entities of your system and group them into high level groups, it&#8217;s time to think about the <strong>code part</strong> of your system.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What do you mean by <em>code part</em>?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> One way to think about it is to identity the <strong>functionalities of your system</strong>.</p>
</div>
<div class="paragraph">
<p>You look again at Nancy&#8217;s requirement napkin and this time you highlight the <strong>verb phrases</strong> that represent functionalities of the system:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Highlighting terms in the requirements that correspond to functionalities</div>
<div class="ulist">
<ul>
<li>
<p>Two kinds of users: library members and librarians</p>
</li>
<li>
<p>Users <strong>log into the system</strong> via email and password.</p>
</li>
<li>
<p>Members can <strong>borrow books</strong></p>
</li>
<li>
<p>Members and librarians can <strong>search books</strong> by title or by author</p>
</li>
<li>
<p>Librarians can <strong>block</strong> and <strong>unblock members</strong> (e.g. when they are late in returning a book)</p>
</li>
<li>
<p>Librarians can <strong>list the books currently lent by a member</strong></p>
</li>
<li>
<p>There could be several copies of a book</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>In addition to that, it is obvious that members can also return a book. Moreover, there should be a way to detect whether a user is a librarian or not.</p>
</div>
<div class="paragraph">
<p>Your write down a list of the functionalities of the system.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">The functionalities of the system</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Search a book</p>
</li>
<li>
<p>Add a book item</p>
</li>
<li>
<p>Block a member</p>
</li>
<li>
<p>Unblock a member</p>
</li>
<li>
<p>Login a user into the system</p>
</li>
<li>
<p>List the books currently lent by a member</p>
</li>
<li>
<p>Borrow a book</p>
</li>
<li>
<p>Return a book</p>
</li>
<li>
<p>Check whether a user is a librarian</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Excellent! Now, tell me what functionalities need to be <strong>exposed to the outside world</strong>?</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What do you mean by <em>exposed to the outside world_</em>?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Imagine that the library management system were exposing an API over HTTP: what would be the endpoints of the API?</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I see. All the functionalities them beside checking if a user is a librarian should need to be exposed.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Perfect, now give to each exposed functionality a short name and gather them together in a box called <code>Library</code></p>
</div>
<div class="paragraph">
<p>Then you draw <a href="#lib-mgmt-entry-points">the exposed functions of the Library</a>.</p>
</div>
<div id="lib-mgmt-entry-points" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/entry-points-lms.png" alt="entry points lms">
</div>
<div class="title">Figure 3. The exposed functions of the Library management system</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The first step in designing the code part of a DO system is to aggregate the exposed functions in a single module.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Beautiful. You just created your first <strong>code module</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> To me it looks like a class: What&#8217;s the difference between a <em>module</em> and a <em>class</em>?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> A <strong>module</strong> is an aggregation of functions. In OO, a module is represented by a class but in other programming languages, it might be a <em>package</em> or a <em>namespace</em>.</p>
</div>
<div class="paragraph">
<p><strong>YOU</strong>: I see.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> The important thing about DO code modules is that they contain only <strong>stateless functions</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> You mean like <strong>static methods</strong> in Java?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Exactly!</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> So how the functions know on what piece of information they operate?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> We pass it as the first argument to the function.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I don&#8217;t understand. Could you give me an example?</p>
</div>
<div class="paragraph">
<p>Joe takes a look at the <a href="#lib-mgmt-entry-points">list of functions</a> of the <code>Library</code> module.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Let&#8217;s take for example <code>getBookLendings()</code>: in classic OO, what would be its arguments?</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> The id of the librarian that wants to list the book lendings and the member id</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> In classic OO,  <code>getBookLendings</code> would be a method of a <code>Library</code> class that receives two arguments: <code>userId</code> and <code>memberId</code></p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Yeap.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Now comes the subtle part: in DO, <code>getBookLendings</code> is part of the library module and it receives the
 <code>LibraryData</code> as the first argument.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Could you show me what you mean?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Sure.</p>
</div>
<div class="paragraph">
<p>Joe gets closer to your keyboard and start typing.</p>
</div>
<div class="paragraph">
<p>That&#8217;s how a class method looks like in OO:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-kr">class</span> <span class="tok-nx">Library</span> <span class="tok-p">{</span>
    <span class="tok-nx">libraryData</span> <span class="tok-c1">// state of the object</span>

    <span class="tok-nx">getBookLendings</span><span class="tok-p">(</span><span class="tok-nx">userId</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-c1">// accesses library data via this.libraryData</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The method accesses the <strong>state</strong> of the object&#8201;&#8212;&#8201;in our case the library data&#8201;&#8212;&#8201; via <code>this.libraryData</code>. The object&#8217;s state is an <strong>implicit argument</strong> to the object&#8217;s methods.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>In classic OO, the state of the object is an <strong>implicit argument</strong> to the methods of the object.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>In DO, the signature of <code>getBookLendings</code> would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-kr">class</span> <span class="tok-nx">Library</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">getBookLendings</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>state</strong> of the library is stored in <code>libraryData</code> and it is passed to the <code>getBookLendings</code> <strong>static</strong> method as an <strong>explicit argument</strong>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>In DO, functions of a code module are <strong>stateless</strong>: they receive the <strong>state they manipulate</strong> as an <strong>explicit argument</strong>, usually the first argument.</p>
</div>
</blockquote>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A <strong>module</strong> is an aggregation of functions. In DO, the module functions are <strong>stateless</strong>.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The same rule applies to the other functions of the library module. All of them are stateless: they receive the library data as first argument.</p>
</div>
<div class="paragraph">
<p>You apply this rule and you refine the <a href="#library-module-args">design of the library module</a> by including the details about functions' arguments.</p>
</div>
<div id="library-module-args" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/library-module-args.png" alt="library module args">
</div>
<div class="title">Figure 4. The Library module with the function arguments</div>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Perfect. We are now ready to design at a high level our system.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What&#8217;s a <strong>high level design in DO</strong>?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> The <strong>definition</strong> of modules and the <strong>interaction</strong> between them.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I see. Is there any guideline to help me define the modules?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Definitely. The <strong>high level modules</strong> of the system correspond to the <strong>high level data entities</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> You mean the data entities that appear in the data mind map?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Exactly!</p>
</div>
<div class="paragraph">
<p>You look again at the <a href="#lms-data-mindmap">data mind map</a> and you focus on the high level data entities: <strong>Library</strong>, <strong>Catalog</strong> and <strong>User management</strong>.</p>
</div>
<div id="lms-data-mindmap" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/lms-data-high-level.png" alt="lms data high level">
</div>
<div class="title">Figure 5. A mindmap of high level data entities of the Library management system</div>
</div>
<div class="paragraph">
<p>It means that in the system, beside, the <code>Library</code> module, we have two high level modules:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Catalog</code> module that deals with catalog data</p>
</li>
<li>
<p><code>UserManagement</code> module that deals with user management data</p>
</li>
</ol>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Code modules</strong> correspond to the <strong>data entities</strong> of the system.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Then you draw the <a href="#lib-mgmt-entry-points-split-args">high level design</a> of library management system, where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Functions of <code>Catalog</code> receive <code>catalogData</code> as first argument</p>
</li>
<li>
<p>Functions of <code>UserManagement</code> receive <code>userManagementData</code> as first argument</p>
</li>
</ul>
</div>
<div id="lib-mgmt-entry-points-split-args" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/entry-points-split-args-lms.png" alt="entry points split args lms">
</div>
<div class="title">Figure 6. The modules of the Library management system with the function arguments</div>
</div>
<div class="paragraph">
<p>It might not be totally clear for you at the moment, how the data entities get passed between modules. For the moment, you can think of <code>libraryData</code> as a class with two members:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>catalog</code> that holds the catalog data</p>
</li>
<li>
<p><code>userManagement</code> that holds the user management data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The functions of <code>Library</code> share a common pattern:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It receives <code>libraryData</code> as an argument</p>
</li>
<li>
<p>It passes <code>libraryData.catalog</code> to functions of <code>Catalog</code></p>
</li>
<li>
<p>It passes <code>libraryData.userManagement</code> to functions of <code>UserManagement</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Later on, in this chapter, we will see code for some functions of the <code>Library</code> module.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The high level <strong>modules</strong> of a DO system correspond to the high level <strong>data entities</strong>.</p>
</div>
</blockquote>
</div>
<h1 id="do-systems-are-easy-to-understand" class="sect0">DO systems are easy to understand</h1>
<div class="paragraph">
<p>You take a look at the two diagrams that represent the high level design of your system:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The data entities in the <a href="#lms-data-mindmap-2">data mind map</a></p>
</li>
<li>
<p>The code modules in the <a href="#lib-mgmt-entry-points-split-args-2">module diagram</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A bit perplexed, you ask Joe:</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I am not sure that this system is better than a classic OO system, where <strong>objects encapsulate data</strong>.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> The main benefit of a DO system over a classic OO systems is that it is <strong>easier to understand</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What makes it easier to understand?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> The fact that the system is split clearly in code modules and data entities.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I don&#8217;t get you.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> When you try to understand the data entities of the system, you don&#8217;t have to think about the details of the code that manipulates the data entities.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> You mean that when I look at the data mind map of my library management system, I am able to understand it on its own?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Exactly. And similarly, when you try to understand the code modules of the system, you don&#8217;t have to think about the details of the data entities manipulated by the code. There is a clear <strong>separation of concerns</strong> between the code and the data.</p>
</div>
<div class="paragraph">
<p>You look again at the <a href="#lms-data-mindmap-2">data mind map</a>, and you get kind of a Aha moment:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Data lives on its own!</p>
</div>
</blockquote>
</div>
<div id="lms-data-mindmap-2" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/lms-data.png" alt="lms data">
</div>
<div class="title">Figure 7. A data mindmap of the Library management system</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A DO system is easier to understand because the system is split in two parts: data entities and code modules.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Now you look at the <a href="#lib-mgmt-entry-points-split-args-2">module diagram</a> and you feel a bit confused:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On one hand, the module diagram looks <strong>similar</strong> to the class diagrams from <strong>classic OO</strong>: boxes for classes and arrows for relations between classes.</p>
</li>
<li>
<p>On the other hand, the code module diagram looks much <strong>simpler</strong> than the class diagrams from <strong>classic OO</strong>, but you cannot explain why.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You ask Joe for a clarification.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> The module diagram seems much simpler that the class diagrams I am used to in OO. I feel it but I cannot put words on it.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> The reason is that module diagrams have <strong>constraints</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What kind of constraints?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> <strong>Constraints on the functions</strong> as we saw before: All the functions are static (stateless). But also <strong>constraints on the relations between the modules</strong>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Could you explain that?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> There is a single kind of relation between DO modules: the <strong>usage relation</strong>. A module uses code from another module. No  <strong>association</strong>, no <strong>composition</strong> and no <strong>inheritance</strong> between modules. That&#8217;s what make a DO module diagram easy to understand.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I understand why there is no association and no composition between DO modules: after all, association and composition are <strong>data relations</strong>. But why no <strong>inheritance</strong> relation? Does it mean that in DO is against <strong>polymorphism</strong>?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> That&#8217;s a great question. The quick answer is that in DO, we achieve polymorphism with a different mechanism than class inheritance. We will talk about it later (in Chapter 5).</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Now, you triggered my curiosity: I was quite sure that inheritance was the only way to achieve polymorphism.</p>
</div>
<div class="paragraph">
<p>You look again at the <a href="#lib-mgmt-entry-points-split-args-2">module diagram</a> and now you not only feel that this diagram is simpler than classic OO class diagrams, you understand why it is simpler: All the functions are static and all the relation between modules are of type usage.</p>
</div>
<div id="lib-mgmt-entry-points-split-args-2" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/entry-points-split-args-lms.png" alt="entry points split args lms">
</div>
<div class="title">Figure 8. The modules of the Library management system with the function arguments</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. What makes each part of a DO system easy to understand</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">System part</th>
<th class="tableblock halign-left valign-top">Constraint on entities</th>
<th class="tableblock halign-left valign-top">Constraints on relations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data entities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Members (no code)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Association and Composition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code modules</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code (no members)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Usage (no inheritance)</p></td>
</tr>
</tbody>
</table>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Each part of a DO system is easy to understand, because it has constraints.</p>
</div>
</blockquote>
</div>
<h1 id="do-systems-are-flexible" class="sect0">DO systems are flexible</h1>
<div class="paragraph">
<p><strong>YOU:</strong> I get that the sharp separation between code and data makes DO systems are easier to understand than classic OO systems. But what about adapting to changes in requirements?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Another benefit of DO systems is that it is <strong>easy to adapt</strong> them to changing requirements.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I remember that when Nancy asked me to add <em>Super Members</em> and <em>VIP Members</em> to the system, it was hard to adapt my OO system: I had to introduce a few base classes and the <strong>class hierarchy became really complex</strong>.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> I know exactly what you are talking about. I experienced the same kind of struggle when I was a OO developer. Tell me what were the changes in the requirements for <em>Super Members</em> and <em>VIP Members</em> and I am quite sure that you will see by yourself that it is easy to adapt your DO system.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">The requirements for Super Members and VIP Members</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Super Members</strong> are members that are allowed to <strong>list the book lendings</strong> of other members</p>
</li>
<li>
<p><strong>VIP Members</strong> are members that are allowed to <strong>add book items</strong> to the library</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>You open your IDE and you start to code the <code>getBookLendings</code> function of the Library module, first without addressing the requirements for Super Members. You remember what Joe told you about module functions in DO:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Functions are <strong>stateless</strong></p>
</li>
<li>
<p>Functions receive the <strong>data</strong> they manipulate as <strong>first argument</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In terms of functionalities, <code>getBookLendings</code> have two parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check that the user is a librarian</p>
</li>
<li>
<p>Retrieve the book lendings from the catalog</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Basically, the code of <code>getBookLendings</code> have two parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Call <code>isLibrarian</code> function from the <code>UserManagement</code> module and pass it the <code>UserManagementData</code></p>
</li>
<li>
<p>Call <code>getBookLendings</code> function from the <code>Catalog</code> module and pass it the <code>CatalogData</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The code for <code>Library.getBookLendings</code> is shown in <a href="#get-book-lendings-lib">this listing</a>.</p>
</div>
<div id="get-book-lendings-lib" class="listingblock">
<div class="title">Getting the book lendings of a member</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-kr">class</span> <span class="tok-nx">Library</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">getBookLendings</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-nx">UserManagement</span><span class="tok-p">.</span><span class="tok-nx">isLibrarian</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">.</span><span class="tok-nx">userManagement</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">))</span> <span class="tok-p">{</span>
            <span class="tok-k">return</span> <span class="tok-nx">Catalog</span><span class="tok-p">.</span><span class="tok-nx">getBookLendings</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">.</span><span class="tok-nx">catalog</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">);</span>
        <span class="tok-p">}</span> <span class="tok-k">else</span> <span class="tok-p">{</span>
            <span class="tok-k">throw</span> <span class="tok-s2">&quot;Not allowed to get book lendings&quot;</span><span class="tok-p">;</span> // <b class="conum">(1)</b>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span>

<span class="tok-kr">class</span> <span class="tok-nx">UserManagement</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">isLibrarian</span><span class="tok-p">(</span><span class="tok-nx">userManagementData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-c1">// will be implemented later </span><b class="conum">(2)</b>
    <span class="tok-p">}</span>
<span class="tok-p">}</span>

<span class="tok-kr">class</span> <span class="tok-nx">Catalog</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">getBookLendings</span><span class="tok-p">(</span><span class="tok-nx">catalogData</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-c1">// will be implemented later </span><b class="conum">(3)</b>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>There are other ways to manage errors</p>
</li>
<li>
<p>In Chapter 3, we will see how to manage permissions with generic data collections</p>
</li>
<li>
<p>In Chapter 3, we will see how to query data with generic data collections</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It&#8217;s your first piece of DO code: passing around all those data objects <code>libraryData</code>, <code>libraryData.userManagement</code> and <code>libraryData.catalog</code> feels a bit awkward. But you made it.</p>
</div>
<div class="paragraph">
<p>Joe looks at your code and seems satisfied.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> How would you adapt your code to adapt to Super Members?</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> I would add a function <code>isSuperMember</code> to the <code>UserManagement</code> module and call it from <code>Library.getBookLendings</code></p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Exactly! It&#8217;s as simple as that.</p>
</div>
<div class="paragraph">
<p>You type this <a href="#get-book-lendings-super">piece of code</a> on your laptop.</p>
</div>
<div id="get-book-lendings-super" class="listingblock">
<div class="title">Allowing Super Members to get the book lendings of a member</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-kr">class</span> <span class="tok-nx">Library</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">getBookLendings</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-nx">Usermanagement</span><span class="tok-p">.</span><span class="tok-nx">isLibrarian</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">.</span><span class="tok-nx">userManagement</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">)</span> <span class="tok-o">||</span>
<span class="hll">           <span class="tok-nx">Usermanagement</span><span class="tok-p">.</span><span class="tok-nx">isSuperMember</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">.</span><span class="tok-nx">userManagement</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">))</span> <span class="tok-p">{</span>
</span>            <span class="tok-k">return</span> <span class="tok-nx">Catalog</span><span class="tok-p">.</span><span class="tok-nx">getBookLendings</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">.</span><span class="tok-nx">catalog</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">);</span>
        <span class="tok-p">}</span> <span class="tok-k">else</span> <span class="tok-p">{</span>
            <span class="tok-k">throw</span> <span class="tok-s2">&quot;Not allowed to get book lendings&quot;</span><span class="tok-p">;</span> // <b class="conum">(1)</b>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span>

<span class="tok-kr">class</span> <span class="tok-nx">UserManagement</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">isLibrarian</span><span class="tok-p">(</span><span class="tok-nx">userManagementData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-c1">// will be implemented later </span><b class="conum">(2)</b>
    <span class="tok-p">}</span>
<span class="hll">    <span class="tok-kr">static</span> <span class="tok-nx">isSuperMember</span><span class="tok-p">(</span><span class="tok-nx">userManagementData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
</span><span class="hll">        <span class="tok-c1">// will be implemented later </span><b class="conum">(2)</b>
</span><span class="hll">    <span class="tok-p">}</span>
</span><span class="tok-p">}</span>

<span class="tok-kr">class</span> <span class="tok-nx">Catalog</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">getBookLendings</span><span class="tok-p">(</span><span class="tok-nx">catalogData</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-c1">// will be implemented later </span><b class="conum">(3)</b>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>There are other ways to manage errors</p>
</li>
<li>
<p>In Chapter 3, we will see how to manage permissions with generic data collections</p>
</li>
<li>
<p>In Chapter 3, we will see how to query data with generic data collections</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now, the awkward feeling caused by passing around all those data objects is dominated by a feeling of relief: Adapting to this change in requirement takes only a few lines of code and require <strong>no changes in the system design</strong>.</p>
</div>
<div class="paragraph">
<p>Once again, Joe seems satisfied.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>DO systems are <strong>flexible</strong>. Quite often, they adapt to changing requirements <strong>without changing the system design</strong>.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>You prepare yourself a cup of coffee, and you start coding the <code>addBookItem</code> code.</p>
</div>
<div class="paragraph">
<p>You look at the <a href="#add-book-item-signature">signature of <code>Library.addBookItem</code></a> and it is not clear to you what is the meaning of the third argument <code>bookItemInfo</code>. You ask Joe for a clarification.</p>
</div>
<div id="add-book-item-signature" class="listingblock">
<div class="title">The signature of <code>Library.addBookItem</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-kr">class</span> <span class="tok-nx">Library</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">addBookItem</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">,</span> <span class="tok-nx">bookItemInfo</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What is <code>booItemInfo</code>?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Let’s call it the book item information and imagine we have a way to <strong>represent this information</strong> in a <strong>data entity</strong> named <code>bookItemInfo</code>.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> You mean an object?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> For now, it’s ok to think about <code>bookItemInfo</code> as on object. Later on (in Chapter 3), I will
show you how to <strong>represent data entities</strong> as <strong>generic data collections</strong>.</p>
</div>
<div class="paragraph">
<p>Beside this subtlety about how the book item info is represented by <code>bookItemInfo</code>, the <a href="#add-book-item-lib">code for <code>Library.addBookItem</code></a> is quite similar to <a href="#get-book-lendings-super">the code you wrote for <code>Library.getBookLendings</code></a>. Once again, you are amazed by the fact that adding support for VIP Members requires <strong>no design change</strong>.</p>
</div>
<div id="add-book-item-lib" class="listingblock">
<div class="title">Allowing VIP Members to add a book item to the library</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span></span><span class="tok-kr">class</span> <span class="tok-nx">Library</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">addBookItem</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">,</span> <span class="tok-nx">bookItemData</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-nx">UserManagement</span><span class="tok-p">.</span><span class="tok-nx">isLibrarian</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">.</span><span class="tok-nx">userManagement</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">)</span> <span class="tok-o">||</span>
<span class="hll">           <span class="tok-nx">UserManagement</span><span class="tok-p">.</span><span class="tok-nx">isVIPMember</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">.</span><span class="tok-nx">userManagement</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">))</span> <span class="tok-p">{</span>
</span>            <span class="tok-k">return</span> <span class="tok-nx">Catalog</span><span class="tok-p">.</span><span class="tok-nx">addBookItem</span><span class="tok-p">(</span><span class="tok-nx">libraryData</span><span class="tok-p">.</span><span class="tok-nx">catalog</span><span class="tok-p">,</span> <span class="tok-nx">bookItemData</span><span class="tok-p">);</span>
        <span class="tok-p">}</span> <span class="tok-k">else</span> <span class="tok-p">{</span>
            <span class="tok-k">throw</span> <span class="tok-s2">&quot;Not allowed to add a book item&quot;</span><span class="tok-p">;</span> // <b class="conum">(1)</b>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span>

<span class="tok-kr">class</span> <span class="tok-nx">UserManagement</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">isLibrarian</span><span class="tok-p">(</span><span class="tok-nx">userManagementData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-c1">// will be implemented later </span><b class="conum">(2)</b>
    <span class="tok-p">}</span>
<span class="hll">    <span class="tok-kr">static</span> <span class="tok-nx">isVIPMember</span><span class="tok-p">(</span><span class="tok-nx">userManagementData</span><span class="tok-p">,</span> <span class="tok-nx">userId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
</span><span class="hll">        <span class="tok-c1">// will be implemented later </span><b class="conum">(2)</b>
</span><span class="hll">    <span class="tok-p">}</span>
</span><span class="tok-p">}</span>

<span class="tok-kr">class</span> <span class="tok-nx">Catalog</span> <span class="tok-p">{</span>
    <span class="tok-kr">static</span> <span class="tok-nx">addBookItem</span><span class="tok-p">(</span><span class="tok-nx">catalogData</span><span class="tok-p">,</span> <span class="tok-nx">memberId</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-c1">// will be implemented later </span><b class="conum">(3)</b>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>There are other ways to manage errors</p>
</li>
<li>
<p>In Chapter 3, we will see how to manage permissions with generic data collections</p>
</li>
<li>
<p>In Chapter 4, we will see how to manage state of the system with immutable data</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> It required a big <strong>mindset shift</strong> for me to learn how to separate code from data.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> What was the most challenging part for your mind?</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> The fact that data is not encapsulated in objects.</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> It was the same for me when I switched from OO to DO.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> Will there be other mindset shifts in my journey into DO?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> There will be two more mindset shifts but I think that they will be less challenging than separating code from data.</p>
</div>
<div class="paragraph">
<p><strong>YOU:</strong> What will it be about?</p>
</div>
<div class="paragraph">
<p><strong>JOE:</strong> Representing data entities as <strong>generic collections</strong> (Chapter 3) and constraining ourselves to <strong>immutable data objects</strong> (Chapter 4).</p>
</div>
<h1 id="wrapping-up" class="sect0">Wrapping up</h1>
<div class="paragraph">
<p>In this chapter we illustrated DO Principle #1 about the separation between code from data:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Principle #1: Separate <strong>code</strong> from <strong>data</strong> in a way that the <strong>code</strong> resides in functions whose behavior does not depend on <strong>data</strong> that is somehow encapsulated in the function&#8217;s context.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>It required quite a big mindset shift to learn that in DO:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code is <strong>separated</strong> from data</p>
</li>
<li>
<p>Code is aggregated in <strong>modules</strong></p>
</li>
<li>
<p>Data is aggregated in <strong>data entities</strong></p>
</li>
<li>
<p>Code is made of <strong>stateless</strong> functions</p>
</li>
<li>
<p>Functions receive <strong>data as first argument</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We illustrated how to apply this principle in a OO language.</p>
</div>
<div class="paragraph">
<p>A consequence of this separation is that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We have the <strong>freedom</strong> to design code and data in isolation</p>
</li>
<li>
<p>Module diagrams are <strong>simple</strong>: it&#8217;s only about usage (no inheritance)</p>
</li>
<li>
<p>Data entities diagram are <strong>simple</strong>: it&#8217;s only about association and composition</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The details of Principle #1 are summarized in <a href="#princuple1-mindmap">this mindmap</a>.</p>
</div>
<div class="paragraph">
<p>Overall, the DO systems are <strong>simpler</strong> (easier to understand) than classic OO systems and <strong>more flexible</strong> (easier to adapt to changing requirements).</p>
</div>
<div id="princuple1-mindmap" class="imageblock">
<div class="content">
<img src="/assets/data-book/uml/chapter02/principle1-mindmap.png" alt="principle1 mindmap">
</div>
<div class="title">Figure 9. The summary of Principle #1: Separate code from data</div>
</div>
<h1 id="oh-my-love" class="sect0">Oh my love</h1>
<div class="paragraph">
<p>What follows is an adaptation of <a href="https://en.wikipedia.org/wiki/Oh_My_Love">Oh My Love</a> by John Lennon and Yoko Ono.</p>
</div>
<div class="paragraph">
<p>Oh my love for the first time in my life<br>
My <strong>system</strong> is <strong>quite simple</strong><br>
Oh my lover for the first time in my life<br>
My <strong>system</strong> can adapt<br></p>
</div>
<div class="paragraph">
<p>I see the <strong>code</strong>, oh I see the <strong>data</strong><br>
Everything is clear in my heart<br>
I see the <strong>code</strong>, oh I see the <strong>data</strong><br>
Everything is clear in my <strong>system</strong><br></p>
</div>
<div class="paragraph">
<p>Oh my love for the first time in my life<br>
My <strong>entities</strong> are <strong>quite simple</strong><br>
Oh my lover for the first time in my life<br>
My <strong>modules</strong> can adapt<br></p>
</div>
<div class="paragraph">
<p>I feel the <strong>arguments</strong>, oh I feel the dreams<br>
Everything is <strong>stateless</strong> in my <strong>code</strong><br>
I feel life, oh I feel love<br>
Everything is clear in my <strong>system</strong><br></p>
</div>
  </div>

</article>
<div class="patreon">
  If you enjoy this kind of interactive articles would you consider a (small) donation💸  on <a href="https://www.patreon.com/bePatron?u=18227864">Patreon</a> or at least giving a star⭐ for the Klispe repo on <a href="https://github.com/viebel/klipse/stargazers"> Github</a>?
</div>




<link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/app.klipse.tech/css/codemirror.css">
<link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/app.klipse.tech/css/prolog.css">

<script>
    window.klipse_settings = {
        codemirror_options_in: {
            lineWrapping: true,
            autoCloseBrackets: true
        },
        codemirror_options_out: {
            lineWrapping: true
        },
        beautify_strings: true,

        selector: '.language-klipse, .language-eval-clj',
        selector_eval_js: '.language-klipse-eval-js, .language-eval-js, [data-lang=klipse-javascript]',
        selector_jsx: '.language-klipse-jsx',
        selector_prolog_rules: '.language-prolog-rules',
        selector_prolog_query: '.language-prolog-query',
        selector_render_jsx: '.language-render-jsx',
        selector_es2017: '.language-es2017',
        selector_brainfuck: '.language-brainfuck',
        selector_transpile_jsx: '.language-transpile-jsx',
        selector_eval_php: '.language-klipse-eval-php',
        selector_eval_markdown: '.language-klipse-markdown',
        selector_eval_lambdaway: '.language-klipse-lambdaway',
        selector_eval_python_client: '.language-klipse-python, .language-eval-python',
        selector_eval_html: '.language-klipse-html',
        selector_sql: '.language-klipse-sql',
        selector_eval_ruby: '.language-klipse-eval-ruby, .language-eval-ruby',
        selector_eval_scheme: '.language-klipse-scheme, .language-eval-scheme',
        selector_eval_clisp: '.language-klipse-clisp',    
        selector_eval_cpp: '.language-klipse-cpp',
        selector_google_charts: '.language-google-chart',
        selector_plot: '.language-plot',
        selector_oblivion: '.language-oblivion',
        selector_lua: '.language-klipse-lua',
        selector_js: '.language-klipse-js',
        selector_eval_ocaml: '.language-klipse-ocaml',
        selector_transpile_ocaml: '.language-transpile-ocaml',
        selector_transpile_reason_3: '.language-transpile-reason',
        selector_transpile_reason_3_to_ocaml: '.language-transpile-reason-to-ocaml',
        selector_eval_reason_3: '.language-klipse-reason',
        selector_eval_reason_3_with_types: '.language-klipse-reason-types',
        selector_eval_ocaml_with_types: '.language-klipse-ocaml-types',
        selector_ocaml_to_reason: '.language-ocaml-to-reason',
        selector_reagent: '.language-reagent',
    };










    

    


</script>



<script src="https://storage.googleapis.com/app.klipse.tech/plugin/js/klipse_plugin.js?v=8.0.1"></script>



<footer class="site-footer">
  
  <div class="wrapper" style="
			      font-size: larger;
			      color: #5f7fbf;
			      font-weight: bold;">
    <p> <span> <!-- <a href="https://twitter.com/viebel">
  <span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span>
  <span class="username">viebel</span>
</a> -->


<a href="https://twitter.com/viebel"
   class="twitter-follow-button" 
   data-show-count="false" 
   data-size="large">Follow viebel</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
 </span> to stay up-to-date with the coolest interactive articles around the world.</p>
    <p> Discover <a href="/"> more cool interactive articles</a> about javascript, clojure[script], python, ruby, scheme, c++ and even brainfuck!</p>
    <p> Give Klipse a Github star
      <span>
  <a class="github-button" href="https://github.com/viebel/klipse" data-size="large" data-show-count="true" aria-label="Star viebel/klipse on GitHub"></a>
      </span>
      to express how much you appreciate <em>Code Interactivity</em>. </p>
    <p>
      <form style="text-align: left;" action="https://tinyletter.com/klipse" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/klipse', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
	<label for="tlemail">Subscribe to the Klipse newsletter:</label>
	<input type="email" style="width:180px" name="email" id="tlemail" placeholder="Enter your email address"/>
	<input type="hidden" value="1" name="embed"/>
	<input style="padding-left:10px; font-size: larger; color: #5f7fbf; font-weight: bold;" type="submit" value="Subscribe" />
      </form>
    </p>
    <p> Feel free to email me <a href="mailto:viebel@gmail.com?Subject=I%20want%20to%20write%20an%20interactive%20blog%20post%20with%20KLIPSE"><span class="icon icon--github"><?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 18.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 382.117 382.117" style="enable-background:new 0 0 382.117 382.117;" xml:space="preserve" width="512px" height="512px">
<path d="M336.764,45.945H45.354C20.346,45.945,0,65.484,0,89.5v203.117c0,24.016,20.346,43.555,45.354,43.555h291.41  c25.008,0,45.353-19.539,45.353-43.555V89.5C382.117,65.484,361.772,45.945,336.764,45.945z M336.764,297.72H45.354  c-3.676,0-6.9-2.384-6.9-5.103V116.359l131.797,111.27c2.702,2.282,6.138,3.538,9.676,3.538l22.259,0.001  c3.536,0,6.974-1.257,9.677-3.539l131.803-111.274v176.264C343.664,295.336,340.439,297.72,336.764,297.72z M191.059,192.987  L62.87,84.397h256.378L191.059,192.987z" fill="#fc8ba0"/>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>
</span><span class="username">viebel@gmail.com</span></a>
 for getting practical tips and tricks in writing your first interactive blog post.</p>
  </div>
</footer>


<div id="disqus_thread"></div>
<script>
    /**
    * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
    */
    var disqus_config = function () {
        this.page.url = "https://blog.klipse.tech/" + "/databook/2020/10/30/data-book-chap2-part1.html";
        this.page.identifier = "BC81B61C-C560-40B5-93DF-3CE46E8127EF";
        this.page.title = "Decrease complexity by separating Code from Data";
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//klipse.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



      </div>
    </div>
    

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75651930-1', 'auto');
  
  	ga('send', 'pageview', {'dimension1': 'Yehonathan Sharvit'});
  

  function timer11(){ga('send', 'event', 'TimeOnPage', '1', '11-30 seconds', { 'nonInteraction': 1 });}
  function timer31(){ga('send', 'event', 'TimeOnPage', '2', '31-60 seconds', { 'nonInteraction': 1 });}
  function timer61(){ga('send', 'event', 'TimeOnPage', '3', '61-180 seconds', { 'nonInteraction': 1 });}
  function timer181(){ga('send', 'event', 'TimeOnPage', '4', '181-600 seconds', { 'nonInteraction': 1 });}
  function timer601(){ga('send', 'event', 'TimeOnPage', '5', '601-1800 seconds', { 'nonInteraction': 1 });}
  function timer1801(){ga('send', 'event', 'TimeOnPage', '6', '1801+ seconds', { 'nonInteraction': 1 });}
  ga('send', 'event', 'TimeOnPage', '0', '0-10 seconds', { 'nonInteraction': 1 });
  setTimeout(timer11,11000);
  setTimeout(timer31,31000);
  setTimeout(timer61,61000);
  setTimeout(timer181,181000);
  setTimeout(timer601,601000);
  setTimeout(timer1801,1801000);
</script>


  </body>
</html>
